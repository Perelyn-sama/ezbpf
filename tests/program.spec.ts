import { assert } from "chai"
import { Program } from '../wasm/node/ezbpf_wasm';

describe('Program', () => {
  it('Disassembles a program', async () => {
    const programBytes = Buffer.from("7F454C460201010000000000000000000300F700010000007800000000000000400000000000000090000000000000000000000040003800010040000300020001000000050000007800000000000000780000000000000078000000000000000800000000000000080000000000000000100000000000009500000000000000002E74657874002E7300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000001000000060000000000000078000000000000007800000000000000080000000000000000000000000000000400000000000000000000000000000007000000030000000000000000000000000000000000000080000000000000000A00000000000000000000000000000001000000000000000000000000000000", "hex");
    let p = Program.from_bytes(programBytes);
    console.log(JSON.stringify(p.to_json()));
  })

  it('Disassembles a program that errors', async () => {
    const programBytes = Buffer.from("7F454C460201010000000000000000000300F700010000002001000000000000400000000000000028020000000000000000000040003800030040000600050001000000050000002001000000000000200100000000000020010000000000003000000000000000300000000000000000100000000000000100000004000000C001000000000000C001000000000000C0010000000000003C000000000000003C000000000000000010000000000000020000000600000050010000000000005001000000000000500100000000000070000000000000007000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007912A000000000007911182900000000B7000000010000002D21010000000000B70000000000000095000000000000001E0000000000000004000000000000000600000000000000C0010000000000000B0000000000000018000000000000000500000000000000F0010000000000000A000000000000000C00000000000000160000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000120001002001000000000000300000000000000000656E747279706F696E7400002E74657874002E64796E737472002E64796E73796D002E64796E616D6963002E73687374727461620000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000010000000600000000000000200100000000000020010000000000003000000000000000000000000000000008000000000000000000000000000000170000000600000003000000000000005001000000000000500100000000000070000000000000000400000000000000080000000000000010000000000000000F0000000B0000000200000000000000C001000000000000C001000000000000300000000000000004000000010000000800000000000000180000000000000007000000030000000200000000000000F001000000000000F0010000000000000C00000000000000000000000000000001000000000000000000000000000000200000000300000000000000000000000000000000000000FC010000000000002A00000000000000000000000000000001000000000000000000000000000000", "hex");
    let p = Program.from_bytes(programBytes);
    console.log(JSON.stringify(p.to_json()));
  })
});